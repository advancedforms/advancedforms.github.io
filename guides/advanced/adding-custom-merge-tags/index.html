<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
  <!--<![endif]-->
  <head>
    <meta charset="utf-8" />

<title>Adding custom merge tags &#8211; Advanced Forms Documentation</title>


<link rel="canonical" href="" />
<link
  href="https://advancedforms.github.io/feed.xml"
  type="application/atom+xml"
  rel="alternate"
  title="Advanced Forms Documentation Feed"
/>

<meta name="description" content="Wordpress plugin for creating flexible and developer-friendly forms using the power of Advanced Custom Fields
" />

<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- For all browsers -->
<link rel="stylesheet" href="https://advancedforms.github.io/assets/css/style.css" />

<meta http-equiv="cleartype" content="on" />

<meta property="og:title" content="Advanced Forms Documentation" />
<meta property="og:description" content="Wordpress plugin for creating flexible and developer-friendly forms using the power of Advanced Custom Fields
" />
<meta property="og:site_name" content="Advanced Forms" />
<meta property="og:type" content="website" />
<meta
  property="og:image"
  content="https://advancedforms.github.io/assets/images/icon-128x128.png"
/>

<script src="https://advancedforms.github.io/assets/js/autocomplete.min.js"></script>
<script src="https://advancedforms.github.io/assets/js/elasticlunr.min.js"></script>

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="https://advancedforms.github.io/assets/js/vendor/html5shiv.min.js"></script>
  <script src="https://advancedforms.github.io/assets/js/vendor/respond.min.js"></script>
<![endif]-->

  </head>

  <body>
    <header>
  <div class="container flex">
    <a class="logo-wrapper" href="/"
      ><img
        src="/assets/images/icon-128x128.png"
        class="logo"
        alt="Advanced Forms logo"
    /></a>

    <div class="search-wrapper">
      <input
        type="text"
        class="search"
        id="search"
        placeholder="Search guides, actions and filters..."
      />
    </div>
  </div>
</header>


    <div class="main container">
      <div class="post">
        <div class="breadcrumb"><a href="/">Home</a> › Adding custom merge tags</div>
        <h1>Adding custom merge tags</h1>
         <p>Advanced Forms has a variety of built-in merge tags which can be used in success messages, emails, and calculated fields. Examples include <code class="highlighter-rouge">{field:NAME}</code> and <code class="highlighter-rouge">{entry_id}</code>. Sometimes it’s desirable to add custom merge tags which we’ll cover in this guide.</p>

<p>To add merge tags we use the <code class="highlighter-rouge">af/merge_tags/resolve</code> filter. This filter will be invoked for every merge tag, that is all occurences of two braces (<code class="highlighter-rouge">{}</code>) with content in between. Because the filter is invoked for every merge tag we first need to check that we’re targeting the right tag.</p>

<p>The following snippet adds a new merge tag <code class="highlighter-rouge">{hello}</code> which will be replaced with the text “Hello” followed by the submitted value for a field named <code class="highlighter-rouge">first_name</code>.</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>

<span class="k">function</span> <span class="nf">add_hello_merge_tag</span><span class="p">(</span> <span class="nv">$output</span><span class="p">,</span> <span class="nv">$tag</span> <span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span> <span class="s1">'hello'</span> <span class="o">!=</span> <span class="nv">$tag</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$output</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="s2">"Hello "</span> <span class="o">.</span> <span class="nx">af_get_field</span><span class="p">(</span> <span class="s1">'first_name'</span> <span class="p">);</span>
<span class="p">}</span>
<span class="nx">add_filter</span><span class="p">(</span> <span class="s1">'af/merge_tags/resolve'</span><span class="p">,</span> <span class="s1">'add_hello_merge_tag'</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span> <span class="p">);</span></code></pre></figure>

<h2 id="adding-merge-tags-to-the-ui">Adding merge tags to the UI</h2>

<p>When editing success messages and emails there is a dropdown which can be used to insert merge tags without having to remember their syntax. Using the <code class="highlighter-rouge">af/merge_tags/custom</code> it’s possible to add custom merge tags to this dropdown. Here’s an example of adding the previously created <code class="highlighter-rouge">{hello}</code> tag:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>

<span class="k">function</span> <span class="nf">register_hello_merge_tag</span><span class="p">(</span> <span class="nv">$tags</span><span class="p">,</span> <span class="nv">$form</span> <span class="p">)</span> <span class="p">{</span>
  <span class="nv">$tags</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'value'</span> <span class="o">=&gt;</span> <span class="s1">'hello'</span><span class="p">,</span>
    <span class="s1">'label'</span> <span class="o">=&gt;</span> <span class="s2">"Hello!"</span><span class="p">,</span>
  <span class="p">);</span>

  <span class="k">return</span> <span class="nv">$tags</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">add_filter</span><span class="p">(</span> <span class="s1">'af/merge_tags/custom'</span><span class="p">,</span> <span class="s1">'register_hello_merge_tag'</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span> <span class="p">);</span></code></pre></figure>

 
      </div>

      <aside class="sidebar">
        <div class="related">
          <p class="heading">Related</p>
          <ul>
              
            <li><a href="/guides/advanced/customizing-validations/">Customizing validations</a></li>
              
            <li><a href="/guides/advanced/adding-custom-restrictions/">Adding custom restrictions</a></li>
              
            <li><a href="/guides/advanced/setting-up-a-form-to-create-posts/">Setting up a form which creates posts</a></li>
              
            <li>Adding custom merge tags</li>
              
            <li><a href="/guides/advanced/decreasing-scripts-and-styles/">Decreasing number of scripts and styles</a></li>
             
          </ul>
        </div>

        <!-- Begin MailChimp Signup Form -->
        <div id="mc_embed_signup" class="newsletter-signup">
          <form
            action="//github.us14.list-manage.com/subscribe/post?u=76d2abc9cd9c93679023ba4de&amp;id=d1d49ef515"
            method="post"
            id="mc-embedded-subscribe-form"
            name="mc-embedded-subscribe-form"
            class="validate"
            target="_blank"
            novalidate
          >
            <div id="mc_embed_signup_scroll">
              <p class="heading">
                Want occasional updates about Advanced Forms?
              </p>

              <div class="mc-field-group">
                <input
                  type="email"
                  value=""
                  name="EMAIL"
                  class="required email"
                  placeholder="Your email address"
                  id="mce-EMAIL"
                />
              </div>

              <div id="mce-responses" class="clear">
                <div
                  class="response"
                  id="mce-error-response"
                  style="display:none"
                ></div>
                <div
                  class="response"
                  id="mce-success-response"
                  style="display:none"
                ></div>
              </div>
              <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
              <div
                style="position: absolute; left: -5000px;"
                aria-hidden="true"
              >
                <input
                  type="text"
                  name="b_76d2abc9cd9c93679023ba4de_d1d49ef515"
                  tabindex="-1"
                  value=""
                />
              </div>
              <div class="clear">
                <input
                  type="submit"
                  value="Subscribe to updates"
                  name="subscribe"
                  id="mc-embedded-subscribe"
                  class="btn small"
                />
              </div>
            </div>
          </form>
        </div>

        <script
          type="text/javascript"
          src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"
        ></script>
        <script type="text/javascript">
          (function($) {
            window.fnames = new Array();
            window.ftypes = new Array();
            fnames[0] = "EMAIL";
            ftypes[0] = "email";
            fnames[1] = "FNAME";
            ftypes[1] = "text";
            fnames[2] = "LNAME";
            ftypes[2] = "text";
          })(jQuery);
          var $mcj = jQuery.noConflict(true);
        </script>
        <!--End mc_embed_signup-->
      </aside>
    </div>

    <script src="https://advancedforms.github.io/assets/js/script.js"></script>

<script>
  (function(i, s, o, g, r, a, m) {
    i["GoogleAnalyticsObject"] = r;
    (i[r] =
      i[r] ||
      function() {
        (i[r].q = i[r].q || []).push(arguments);
      }),
      (i[r].l = 1 * new Date());
    (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m);
  })(
    window,
    document,
    "script",
    "https://www.google-analytics.com/analytics.js",
    "ga"
  );

  ga("create", "UA-45755328-16", "auto");
  ga("send", "pageview");
</script>

  </body>
</html>
